sinteractive -A microbiome -t 6:00:00 -N4 -n80 #new command Getting set upYou will need the necessary modules to run qiimemodule load bioinfomodule load mothermothur  make.file(inputdir=., type=gz, prefix=ControlBeef.stability)module load Qiime/2-2022.8 qiime tools import \--type 'SampleData[PairedEndSequencesWithQuality]' \--input-path ControlBeefMock.stability.files.txt \--input-format PairedEndFastqManifestPhred33V2 \--output-path ./Qiime_mock/demux-paired-end.qzaqiime demux summarize \  --i-data ./Qiime_mock/demux-paired-end.qza \  --o-visualization ./Qiime_mock/demux-paired-endMockBeef.qzvFeatures: 384696Sequences: 1545098qiime dada2 denoise-paired \  --i-demultiplexed-seqs ./Qiime_mock/demux-paired-end.qza \  --p-trim-left-f 0 \  --p-trim-left-r 0 \  --p-trunc-len-f 232 \  --p-trunc-len-r 187 \  --o-table ./Qiime_mock/table.qza \  --o-representative-sequences ./Qiime_mock/rep-seqsMockBeef.qza \  --o-denoising-stats ./Qiime_mock/denoising-statsMockBeef.qzaFeatureTable and FeatureData summariesqiime feature-table summarize \  --i-table ./Qiime_mock/table.qza \  --o-visualization ./Qiime_mock/table.qzv \  --m-sample-metadata-file BRDBigControlsBeefMock.txtqiime feature-table tabulate-seqs \  --i-data ./Qiime_mock/rep-seqs.qza \  --o-visualization ./Qiime_mock/rep-seqs.qzv qiime metadata tabulate \  --m-input-file ./Qiime_mock/denoising-stats.qza \  --o-visualization ./Qiime_mock/denoising-stats.qzvSamples:6Features: 158Sequences:320,408Generating the phylogenetic treeqiime phylogeny align-to-tree-mafft-fasttree \  --i-sequences ./Qiime_mock/rep-seqsMockBeef.qza \  --o-alignment ./Qiime_mock/aligned-rep-seqs.qza \  --o-masked-alignment ./Qiime_mock/masked-aligned-rep-seqs.qza \  --o-tree ./Qiime_mock/unrooted-tree.qza \  --o-rooted-tree ./Qiime_mock/rooted-tree.qzaTaxonomic analysis using GreenGenesqiime feature-classifier classify-sklearn \  --i-classifier silva-138-99-515-806-nb-classifier.qza \  --i-reads ./Qiime_mock/rep-seqsMockBeef.qza \  --o-classification ./Qiime_mock/taxonomyControls.qzaqiime metadata tabulate \  --m-input-file ./Qiime_mock/taxonomyControls.qza \  --o-visualization ./Qiime_mock/taxonomyControls.qzvqiime taxa barplot \  --i-table ./Qiime_mock/table.qza \  --i-taxonomy ./Qiime_mock/taxonomyControls.qza \  --m-metadata-file BRDBigControlsBeefMock.txt \  --o-visualization ./Qiime_mock/taxa-bar-plotsMockBeef.qzv## in the empty tubes pseudoalteromonas and vibrio are the most abundant againImporting dataqiime tools import \  --input-path ATCC_20strain_mock.fasta \  --output-path ATCC_20strain_mock.qza \  --type 'FeatureData[Sequence]'This is to compare the Mock community to a reference mock community filesEvaluating sequence qualityqiime quality-control evaluate-seqs \  --i-query-sequences ./Qiime_mock/rep-seqsMockBeef.qza \  --i-reference-sequences ATCC_20strain_mock.qza \--p-show-alignments \  --o-visualization ./Qiime_mock/eval-seqs-testBeefMock.qzvqiime tools export --input-path ./taxonomyMockDairyUpdated.qza --output-path ./#check all the controls
qiime tools import \--type 'SampleData[PairedEndSequencesWithQuality]' \--input-path ControlBeef.stability.files \--input-format PairedEndFastqManifestPhred33V2 \--output-path ./Qiime_new/demux-paired-end.qzaqiime demux summarize \  --i-data ./Qiime_new/demux-paired-end.qza \  --o-visualization ./Qiime_new/demux-paired-endControlBeef.qzvFeatures: 384696Sequences: 1545098qiime dada2 denoise-paired \  --i-demultiplexed-seqs ./Qiime_new/demux-paired-end.qza \  --p-trim-left-f 0 \  --p-trim-left-r 0 \  --p-trunc-len-f 0 \  --p-trunc-len-r 120 \  --o-table ./Qiime_new/table.qza \  --o-representative-sequences ./Qiime_new/rep-seqsControlBeef.qza \  --o-denoising-stats ./Qiime_new/denoising-statsControlBeef.qzaFeatureTable and FeatureData summariesqiime feature-table summarize \  --i-table ./Qiime_new/table.qza \  --o-visualization ./Qiime_new/table.qzv \  --m-sample-metadata-file BRDBigControlsBeef.txtSamples:6Features: 158Sequences:320,408Generating the phylogenetic treeqiime phylogeny align-to-tree-mafft-fasttree \  --i-sequences ./Qiime_new/rep-seqsControlBeef.qza \  --o-alignment ./Qiime_new/aligned-rep-seqs.qza \  --o-masked-alignment ./Qiime_new/masked-aligned-rep-seqs.qza \  --o-tree ./Qiime_new/unrooted-tree.qza \  --o-rooted-tree ./Qiime_new/rooted-tree.qzaTaxonomic analysis using GreenGenesqiime feature-classifier classify-sklearn \  --i-classifier silva-138-99-515-806-nb-classifier.qza \  --i-reads ./Qiime_new/rep-seqsControlBeef.qza \  --o-classification ./Qiime_new/taxonomyControlsBeef.qzaqiime metadata tabulate \  --m-input-file ./Qiime_new/taxonomyControlsBeef.qza \  --o-visualization ./Qiime_new/taxonomyControlsBeef.qzvqiime taxa barplot \  --i-table ./Qiime_new/table.qza \  --i-taxonomy ./Qiime_new/taxonomyControlsBeef.qza \  --m-metadata-file BRDBigControlsBeef.txt \  --o-visualization ./Qiime_new/taxa-bar-plotsControlsBeef.qzv

#adjust compositional data with no zeros
biom convert -i TX_OTUBeefMetadata.tsv -o TX_OTUBeefMetadata.biom --to-hdf5

qiime tools import \
--input-path TX_OTUDairyMetadata.biom \
--type 'FeatureTable[Frequency]' \
--input-format BIOMV210Format \
--output-path TX_OTUDairyMetadata.qza

qiime composition add-pseudocount \
  --i-table TX_OTUDairyMetadata.qza \
  --o-composition-table ./ANCOM/comp-TX_OTUDairyMetadata.qza

Run ANCOM

qiime composition ancom \
  --i-table ./ANCOM/comp-NY_OTUDairyMetadata.qza \
  --m-metadata-file NYDairyMetadata.txt \
  --m-metadata-column Status \
  --o-visualization ./ANCOM/ancom-NYDairyStatus.qzv

